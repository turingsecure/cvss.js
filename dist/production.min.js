var CVSS=function(e){var n={};function r(a){if(n[a])return n[a].exports;var i=n[a]={i:a,l:!1,exports:{}};return e[a].call(i.exports,i,i.exports,r),i.l=!0,i.exports}return r.m=e,r.c=n,r.d=function(e,n,a){r.o(e,n)||Object.defineProperty(e,n,{enumerable:!0,get:a})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,n){if(1&n&&(e=r(e)),8&n)return e;if(4&n&&"object"==typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(r.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&n&&"string"!=typeof e)for(var i in e)r.d(a,i,function(n){return e[n]}.bind(null,i));return a},r.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(n,"a",n),n},r.o=function(e,n){return Object.prototype.hasOwnProperty.call(e,n)},r.p="",r(r.s=1)}([function(e,n,r){const a=r(3),i=function(e){return a.definitions.find(n=>n.abbr===e)};e.exports={roundUpExact:function(e){const n=Math.round(1e5*e);return n%1e4==0?n/1e5:(Math.floor(n/1e4)+1)/10},roundUpApprox:function(e,n){return n=Math.pow(10,n),Math.ceil(e*n)/n},getVectorObject:function(e){const n=e.split("/"),r={};a.definitions.forEach(e=>r[e.abbr]="X");for(const e of n){const n=e.split(":");r[n[0]]=n[1]}return r},getDetailedVectorObject:function(e){return e.split("/").reduce((e,n,r)=>{const a=n.split(":"),t={...e.metrics};if(r){const n=i(a[0]),r={name:n.name,abbr:n.abbr,fullName:`${n.name} (${n.abbr})`,value:n.metrics.find(e=>e.abbr===a[1]).name,valueAbbr:a[1]};return Object.assign(e,{metrics:Object.assign(t,{[a[0].trim()]:r})})}return Object.assign(e,{[a[0].trim()]:a[1]})},{metrics:{}})},findMetric:i,findMetricValue:function(e,n){const r=i(e);return r.metrics.find(e=>e.abbr===n[r.abbr])},getRating:function(e){let n="None";return n=0===e?"None":e<=3.9?"Low":e<=6.9?"Medium":e<=8.9?"High":"Critical",n},isVectorValid:function(e){const n=a.definitions.reduce((e,n,r)=>{const a=`${n.abbr}:[${n.metrics.reduce((e,n)=>e+n.abbr,"")}]`;return 0!==r?`(${e}|${a})`:a},"");if(!new RegExp("^CVSS:3.(0|1)(/"+n+")+$").test(e))return!1;const r=a.definitions.map(e=>new RegExp(`/${e.abbr}:[${e.metrics.reduce((e,n)=>e+n.abbr,"")}]`,"g"));for(const n of r)if((e.match(n)||[]).length>1)return!1;const i=[/\/AV:[NALP]/g,/\/AC:[LH]/g,/\/PR:[NLH]/g,/\/UI:[NR]/g,/\/S:[UC]/g,/\/C:[NLH]/g,/\/I:[NLH]/g,/\/A:[NLH]/g];for(const n of i)if((e.match(n)||[]).length<1)return!1;return!0},parseVectorObjectToString:function(e){if("string"==typeof e)return e;let n=`CVSS:${e.CVSS}/`;for(const r of a.definitions){const a=r.abbr;Object.prototype.hasOwnProperty.call(e,a)&&(n+=`${a}:${e[a]}/`)}return n=n.slice(0,-1),n},getVersion:function(e){const n=e.split("/");return"CVSS:3.0"===n[0]?"3.0":"CVSS:3.1"===n[0]?"3.1":"Error"},getCleanVectorString:function(e){const n=e.split("/"),r=[];for(const e of n){"X"!==e.split(":")[1]&&r.push(e)}return r.join("/")}}},function(e,n,r){const a=r(2);e.exports=a},function(e,n,r){const a=r(0),i=r(4);e.exports=function(e){function n(){return a.getVersion(e)}function r(){return i.getScore(e)}function t(){return i.getTemporalScore(e)}function c(){return i.getEnvironmentalScore(e)}var o;if(o=e,e=a.parseVectorObjectToString(o),"Error"===n())throw new Error("The vector version is not valid");const b=a.isVectorValid(e);if(!b)throw new Error("The vector format is not valid!");return{vector:e,getScore:r,getTemporalScore:t,getEnvironmentalScore:c,getRating:function(){return a.getRating(r())},getTemporalRating:function(){return a.getRating(t())},getEnvironmentalRating:function(){return a.getRating(c())},getVectorObject:function(){return a.getVectorObject(e)},getDetailedVectorObject:function(){return a.getDetailedVectorObject(e)},getVersion:n,getCleanVectorString:function(){return a.getCleanVectorString(e)},isValid:b}}},function(e){e.exports=JSON.parse('{"version":"3.0","definitions":[{"name":"Attack Vector","abbr":"AV","metrics":[{"name":"Network","abbr":"N","numerical":0.85},{"name":"Adjacent","abbr":"A","numerical":0.62},{"name":"Local","abbr":"L","numerical":0.55},{"name":"Physical","abbr":"P","numerical":0.2}]},{"name":"Attack Complexity","abbr":"AC","metrics":[{"name":"Low","abbr":"L","numerical":0.77},{"name":"High","abbr":"H","numerical":0.44}]},{"name":"Privileges Required","abbr":"PR","metrics":[{"name":"None","abbr":"N","numerical":{"changed":0.85,"unchanged":0.85}},{"name":"Low","abbr":"L","numerical":{"changed":0.68,"unchanged":0.62}},{"name":"High","abbr":"H","numerical":{"changed":0.5,"unchanged":0.27}}]},{"name":"User Interaction","abbr":"UI","metrics":[{"name":"None","abbr":"N","numerical":0.85},{"name":"Required","abbr":"R","numerical":0.62}]},{"name":"Scope","abbr":"S","metrics":[{"name":"Unchanged","abbr":"U"},{"name":"Changed","abbr":"C"}]},{"name":"Confidentiality","abbr":"C","metrics":[{"name":"None","abbr":"N","numerical":0},{"name":"Low","abbr":"L","numerical":0.22},{"name":"High","abbr":"H","numerical":0.56}]},{"name":"Integrity","abbr":"I","metrics":[{"name":"None","abbr":"N","numerical":0},{"name":"Low","abbr":"L","numerical":0.22},{"name":"High","abbr":"H","numerical":0.56}]},{"name":"Availability","abbr":"A","metrics":[{"name":"None","abbr":"N","numerical":0},{"name":"Low","abbr":"L","numerical":0.22},{"name":"High","abbr":"H","numerical":0.56}]},{"name":"Exploit Code Maturity","abbr":"E","metrics":[{"name":"Not Defined","abbr":"X","numerical":1},{"name":"High","abbr":"H","numerical":1},{"name":"Functional","abbr":"F","numerical":0.97},{"name":"Proof of Concept","abbr":"P","numerical":0.94},{"name":"Unproven","abbr":"U","numerical":0.91}]},{"name":"Remediation Level","abbr":"RL","metrics":[{"name":"Not Defined","abbr":"X","numerical":1},{"name":"Unavailable","abbr":"U","numerical":1},{"name":"Workaround","abbr":"W","numerical":0.97},{"name":"Temporary Fix","abbr":"T","numerical":0.96},{"name":"Official Fix","abbr":"O","numerical":0.95}]},{"name":"Report Confidence","abbr":"RC","metrics":[{"name":"Not Defined","abbr":"X","numerical":1},{"name":"Confirmed","abbr":"C","numerical":1},{"name":"Reasonable","abbr":"R","numerical":0.96},{"name":"Unknown","abbr":"U","numerical":0.92}]},{"name":"Confidentiality Req.","abbr":"CR","metrics":[{"name":"Not Defined","abbr":"X","numerical":1},{"name":"High","abbr":"H","numerical":1.5},{"name":"Medium","abbr":"M","numerical":1},{"name":"Low","abbr":"L","numerical":0.5}]},{"name":"Integrity Req.","abbr":"IR","metrics":[{"name":"Not Defined","abbr":"X","numerical":1},{"name":"High","abbr":"H","numerical":1.5},{"name":"Medium","abbr":"M","numerical":1},{"name":"Low","abbr":"L","numerical":0.5}]},{"name":"Availability Req.","abbr":"AR","metrics":[{"name":"Not Defined","abbr":"X","numerical":1},{"name":"High","abbr":"H","numerical":1.5},{"name":"Medium","abbr":"M","numerical":1},{"name":"Low","abbr":"L","numerical":0.5}]},{"name":"Modified Attack Vector","abbr":"MAV","metrics":[{"name":"Not Defined","abbr":"X","numerical":1},{"name":"Network","abbr":"N","numerical":0.85},{"name":"Adjacent","abbr":"A","numerical":0.62},{"name":"Local","abbr":"L","numerical":0.55},{"name":"Physical","abbr":"P","numerical":0.2}]},{"name":"Modified Attack Complexity","abbr":"MAC","metrics":[{"name":"Not Defined","abbr":"X","numerical":1},{"name":"Low","abbr":"L","numerical":0.77},{"name":"High","abbr":"H","numerical":0.44}]},{"name":"Modified Privileges Required","abbr":"MPR","metrics":[{"name":"Not Defined","abbr":"X","numerical":{"changed":1,"unchanged":1}},{"name":"None","abbr":"N","numerical":{"changed":0.85,"unchanged":0.85}},{"name":"Low","abbr":"L","numerical":{"changed":0.68,"unchanged":0.62}},{"name":"High","abbr":"H","numerical":{"changed":0.5,"unchanged":0.27}}]},{"name":"Modified User Interaction","abbr":"MUI","metrics":[{"name":"Not Defined","abbr":"X","numerical":1},{"name":"None","abbr":"N","numerical":0.85},{"name":"Required","abbr":"R","numerical":0.62}]},{"name":"Modified Scope","abbr":"MS","metrics":[{"name":"Not Defined","abbr":"X"},{"name":"Unchanged","abbr":"U"},{"name":"Changed","abbr":"C"}]},{"name":"Modified Confidentiality","abbr":"MC","metrics":[{"name":"Not Defined","abbr":"X","numerical":1},{"name":"None","abbr":"N","numerical":0},{"name":"Low","abbr":"L","numerical":0.22},{"name":"High","abbr":"H","numerical":0.56}]},{"name":"Modified Integrity","abbr":"MI","metrics":[{"name":"Not Defined","abbr":"X","numerical":1},{"name":"None","abbr":"N","numerical":0},{"name":"Low","abbr":"L","numerical":0.22},{"name":"High","abbr":"H","numerical":0.56}]},{"name":"Modified Availability","abbr":"MA","metrics":[{"name":"Not Defined","abbr":"X","numerical":1},{"name":"None","abbr":"N","numerical":0},{"name":"Low","abbr":"L","numerical":0.22},{"name":"High","abbr":"H","numerical":0.56}]}]}')},function(e,n,r){const a=r(0);function i(e){const n=a.getVectorObject(e),r="C"===n.S,i=t(n),o=c(i,r,e);if(o<=0)return 0;const u=b(n,r);return m(r?Math.min(1.08*(o+u),10):Math.min(o+u,10),1,e)}const t=function(e){return 1-(1-a.findMetricValue("C",e).numerical)*(1-a.findMetricValue("I",e).numerical)*(1-a.findMetricValue("A",e).numerical)};const c=function(e,n,r){return n?"3.0"===a.getVersion(r)||"3.1"===a.getVersion(r)?7.52*(e-.029)-3.25*Math.pow(e-.02,15):void 0:6.42*e},o=function(e,n,r){return n?"3.0"===a.getVersion(r)?7.52*(e-.029)-3.25*Math.pow(e-.02,15):"3.1"===a.getVersion(r)?7.52*(e-.029)-3.25*Math.pow(.9731*e-.02,13):void 0:6.42*e},b=function(e,n){const r=a.findMetricValue("AV",e).numerical,i=a.findMetricValue("AC",e).numerical,t=a.findMetricValue("PR",e).numerical,c=a.findMetricValue("UI",e).numerical;return 8.22*r*i*(n?t.changed:t.unchanged)*c};const u=function(e,n){let r=a.findMetricValue("MAV",e),i=a.findMetricValue("MAC",e),t=a.findMetricValue("MPR",e),c=a.findMetricValue("MUI",e);r&&"X"!==r.abbr||(r=a.findMetricValue("AV",e)),i&&"X"!==i.abbr||(i=a.findMetricValue("AC",e)),t&&"X"!==t.abbr||(t=a.findMetricValue("PR",e)),c&&"X"!==c.abbr||(c=a.findMetricValue("UI",e));const o=n?t.numerical.changed:t.numerical.unchanged;return 8.22*r.numerical*i.numerical*o*c.numerical};function m(e,n,r){return"3.0"===a.getVersion(r)?a.roundUpApprox(e,n):"3.1"===a.getVersion(r)?a.roundUpExact(e):void 0}e.exports={getScore:i,getTemporalScore:function(e){const n=a.getVectorObject(e),r=i(e),t=a.findMetricValue("E",n),c=t?t.numerical:1,o=a.findMetricValue("RL",n),b=o?o.numerical:1,u=a.findMetricValue("RC",n);return m(r*c*b*(u?u.numerical:1),1,e)},getEnvironmentalScore:function(e){const n=a.getVectorObject(e),r="X"===n.MS?"C"===n.S:"C"===n.MS,i=function(e){let n=a.findMetricValue("MC",e),r=a.findMetricValue("MI",e),i=a.findMetricValue("MA",e);const t=a.findMetricValue("CR",e).numerical,c=a.findMetricValue("IR",e).numerical,o=a.findMetricValue("AR",e).numerical;n&&"X"!==n.abbr||(n=a.findMetricValue("C",e));r&&"X"!==r.abbr||(r=a.findMetricValue("I",e));i&&"X"!==i.abbr||(i=a.findMetricValue("A",e));return Math.min(1-(1-n.numerical*t)*(1-r.numerical*c)*(1-i.numerical*o),.915)}(n),t=u(n,r),c=o(i,r,e);if(c<=0)return 0;const b=a.findMetricValue("E",n),l=a.findMetricValue("RL",n),f=a.findMetricValue("RC",n),d=b?b.numerical:1,s=l?l.numerical:1,g=f?f.numerical:1;return m(r?m(Math.min(1.08*(c+t),10),1,e)*d*s*g:m(Math.min(c+t,10),1,e)*d*s*g,1,e)}}}]);